<!doctype html>
<html lang="he" dir="rtl">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>עורך תמלילים</title>

  <!-- Link CSS later -->
  <link rel="stylesheet" href="styles.css">
</head>

<body>

  <!-- Top app header: audio player & controls -->
  <header role="banner">
    <section class="card" id="playerCard" aria-labelledby="playerCardTitle">
      <h2 id="playerCardTitle" class="visually-hidden">נגן אודיו</h2>

      <div class="head">
        <!-- Right cluster: settings, keyboard help, VTT download -->
        <div class="cluster right">

          <details class="hint" id="kbdHelp">
            <summary aria-label="קיצורי מקלדת">⌨️ קיצורים</summary>
            <div>
              קליק ימני לעריכת הטקסט · Enter לשמירה · Esc לביטול · Ctrl+Z לביטול · Ctrl+Shift+Z לשחזור
            </div>
          </details>

          <button class="pill" id="dlVtt" type="button" title="הורד VTT" aria-label="הורד VTT">⬇️ VTT</button>
          <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode"> <span id="themeIcon"
              aria-hidden="true">🌙</span> </button>
        </div>

        <!-- Center: audio element (should flex / grow with CSS) -->
        <audio id="player" controls crossorigin="anonymous" preload="metadata" aria-describedby="meta err"></audio>

        <!-- Left cluster: speed control -->
        <div class="cluster left" role="group" aria-label="מהירות ניגון">
          <label for="rate">מהירות:</label>
          <input id="rate" type="range" min="0.3" max="3" step="0.05" value="1" aria-describedby="rateVal" />
          <span id="rateVal" class="hint" role="status" aria-live="polite">×1.00</span>
        </div>
      </div>
    </section>
  </header>

  <!-- Error / status line -->
  <div id="err" role="status" aria-live="polite"></div>

  <!-- Main 3-column panel with resizable gutters -->
  <main id="panel">


    <!-- Browser (folders/files) -->
    <section class="card" id="browserCard" aria-labelledby="browserCardTitle">
      <div class="head">
        <div class="tabs" role="tablist" aria-label="nav">
          <button id="tabBrowser" class="tab-btn" role="tab" aria-selected="true"
            aria-controls="panelBrowser">דפדוף</button>
          <button id="tabSearch" class="tab-btn" role="tab" aria-selected="false"
            aria-controls="panelSearch">חיפוש</button>
        </div>
      </div>

      <div class="body">
        <div id="panelBrowser" class="tab-panel" role="tabpanel" aria-labelledby="tabBrowser">
          <div id="browserGrid" class="grid">
            <div class="list" id="folders" aria-label="תיקיות"></div>
            <div class="list" id="files" aria-label="קבצים"></div>
          </div>
        </div>
        <div id="panelSearch" class="tab-panel" role="tabpanel" aria-labelledby="tabSearch" hidden>
          <div class="actions" role="group" aria-label="חיפוש">
            <input id="searchInput" type="search" placeholder="חפש..." aria-label="חיפוש" />
            <button id="searchBtn" class="pill" type="button">חפש</button>
          </div>
          <div id="searchResults" class="list" aria-label="תוצאות חיפוש" style="margin-top:8px;"></div>
          <div class="pager" id="searchPager" role="navigation" aria-label="ניווט תוצאות"
            style="margin-top:8px;display:flex;gap:8px;">
            <button id="searchPrev" class="pill" type="button">קודם</button>
            <span id="searchPageInfo" class="hint"></span>
            <button id="searchNext" class="pill" type="button">הבא</button>
          </div>
        </div>
      </div>
    </section>
    <!-- Gutter between browser & transcript -->
    <div id="gutterR" class="gutter" role="separator" aria-orientation="vertical" tabindex="0"
      aria-label="שינוי רוחב הדפדפן"></div>

    <!-- Transcript editor -->
    <section class="card" id="transcriptCard" aria-labelledby="transcriptCardTitle">
      <div class="head">
        <h2 id="transcriptCardTitle">תמלול <span id="versionBadge" class="hint"></span></h2>
        <div class="actions" role="group" aria-label="פקדי תמליל">
          <button id="submitBtn" class="pill save" type="button" aria-controls="transcript">⬆️ שמור תיקון</button>
          <button id="probToggle" class="pill" type="button" aria-pressed="false" title="הדגש ודאות נמוכה">הדגש ודאות
            נמוכה</button>
          <button id="fontMinus" class="pill" type="button" aria-controls="transcript" title="הקטן גופן">A−</button>
          <button id="fontPlus" class="pill" type="button" aria-controls="transcript" title="הגדל גופן">A+</button>
          <!-- Confirmation tools (JS will show/hide) -->
          <button id="markReliable" class="pill" type="button">✅ אשר קטע מסומן</button>
          <button id="markUnreliable" class="pill" type="button">❎ בטל אישור</button>
        </div>
      </div>

      <div class="body">
        <div id="transcript" class="transcript" dir="auto" contenteditable="true" spellcheck="false"
          aria-label="תצוגת התמליל לעריכה"></div>
      </div>
    </section>

    <!-- Gutter between transcript & diff -->
    <div id="gutterL" class="gutter" role="separator" aria-orientation="vertical" tabindex="0"
      aria-label="שינוי רוחב אזור ההשוואה"></div>



    <!-- Diff / History -->
    <section class="card" id="diffCard" aria-labelledby="diffCardTitle">
      <div class="head">
        <div class="tabs" role="tablist" aria-label="diff-history">
          <button id="tabDiff" class="tab-btn" role="tab" aria-selected="true"
            aria-controls="panelDiff">השוואות</button>
          <button id="tabHistory" class="tab-btn" role="tab" aria-selected="false"
            aria-controls="panelHistory">היסטוריה</button>
          <button id="showLayersBtn" class="tab-btn" type="button" title="שכבות שינויים">שכבות שינויים</button>
      </div>
      <div class="body">
        <div id="panelDiff" class="tab-panel" role="tabpanel" aria-labelledby="tabDiff">
          <div id="diffBody" dir="auto" aria-live="polite" aria-label="תצוגת השוואות"></div>
        </div>
        <div id="panelHistory" class="tab-panel" role="tabpanel" aria-labelledby="tabHistory" hidden>
          <div id="historyList" class="list" aria-label="רשימת גרסאות"></div>
        </div>
      </div>
    </section>

    <!-- History sidebar -->

  </main>

  <!-- Back-to-top floating button -->
  <button id="scrollTopBtn" class="fab" type="button" aria-label="חזור למעלה" title="למעלה">⬆️</button>

  <!-- Toast notifications -->
  <div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="true"></div>

  <!-- Dev metrics HUD (toggle with Ctrl+Alt+D) -->
  <div id="hud" class="hud" aria-hidden="true" style="display:none"></div>

  <!-- Merge conflict modal -->
  <div id="mergeModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="mergeTitle">
    <div class="modal-content" role="document">
      <header class="modal-head">
        <h3 id="mergeTitle">התנגשות גרסאות</h3>
      </header>
      <div class="modal-body" style="max-height:50vh; overflow:auto;">
        <p>נמצאה התנגשות בשמירה. להלן ההבדלים:</p>
        <div class="grid" style="grid-template-columns:1fr 1fr; gap:8px;">
          <div>
            <h4 style="margin-top:0">בסיס → העדכנית</h4>
            <pre id="diffParentLatest"
              style="white-space:pre-wrap; background:var(--bg-2); padding:8px; border-radius:6px;"></pre>
          </div>
          <div>
            <h4 style="margin-top:0">בסיס → השינויים שלי</h4>
            <pre id="diffParentClient"
              style="white-space:pre-wrap; background:var(--bg-2); padding:8px; border-radius:6px;"></pre>
          </div>
        </div>
      </div>
      <footer class="modal-foot">
        <button id="mergeReload" class="pill" type="button">טען העדכנית</button>
        <button id="mergeTry" class="pill" type="button">מיזוג אוטומטי (בטא)</button>
        <button id="mergeClose" class="pill" type="button">סגור</button>
      </footer>
    </div>
  </div>

  <!-- Optional meta paragraph referenced by audio aria-describedby -->
  <p id="meta" class="visually-hidden">מידע על קובץ האודיו יוצג כאן.</p>

  <!-- Link JS later -->
  <script type="module" src="main.js"></script>
</body>

</html>
